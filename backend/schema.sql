create table buddy (clothes_id bigint not null, color_id bigint not null, created_at TIMESTAMPTZ not null, hair_style_id bigint not null, id bigint generated by default as identity, updated_at TIMESTAMPTZ not null, user_id bigint not null unique, name TEXT not null, nickname TEXT not null, primary key (id));
create table diary (date date not null, id integer generated by default as identity, created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, user_id bigint not null, body TEXT not null, title varchar(255) not null, primary key (id));
create table notification_target_token (created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, id bigint generated by default as identity, updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, user_id bigint not null, target_token TEXT not null unique, primary key (id));
create table taak_user (created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, id bigint generated by default as identity, updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, line_sub TEXT unique, password TEXT not null, username TEXT not null unique, primary key (id));
create table taak_task (id integer generated by default as identity, is_all_day boolean not null, load_score integer not null, completed_at timestamp(6), due_at timestamp(6) not null, user_id bigint not null, memo TEXT not null, title varchar(255) not null, primary key (id));
create table taak_user_roles (taak_user_id bigint not null, roles varchar(255));
create table task_reminder (task_id integer not null, created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, id bigint generated by default as identity, scheduled_at TIMESTAMP WITH TIME ZONE not null, updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, primary key (id));
create index idx_notification_target_token_user_id on notification_target_token (user_id);
create index idx_taakuser_username on taak_user (username);
create index idx_task_reminder_task_id on task_reminder (task_id);
create index idx_task_reminder_scheduled_at on task_reminder (scheduled_at);
alter table if exists buddy add constraint FKly0o9pktdliup3rcudpeyvwho foreign key (user_id) references taak_user;
alter table if exists diary add constraint FKicd4egl46ha9186c3qi4f7kh7 foreign key (user_id) references taak_user;
alter table if exists notification_target_token add constraint FKiscc6ualagsm7gbel538i99gu foreign key (user_id) references taak_user;
alter table if exists taak_task add constraint FKnx44vkinsf3rvymxg6em30dp9 foreign key (user_id) references taak_user;
alter table if exists taak_user_roles add constraint FKoahoj7by44rbh3ke1txr22udo foreign key (taak_user_id) references taak_user;
alter table if exists task_reminder add constraint FKj8q5lgknjwjvl3wav7e92inxe foreign key (task_id) references taak_task;
